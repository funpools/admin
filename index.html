<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
  <title>Fun Sports Pools Admin</title>
  <link rel="shortcut icon" href="favicon.ico" />
  <link rel="stylesheet" href="framework7.bundle.css">
  <link rel="stylesheet" href="main.css">
</head>

<body class="aurora">
  <div id="app">
    <div class="statusbar"></div>
    <div class="view view-main">
      <div data-name="home" class="page">
        <div class="page-content">
          <div class="row" style="height: 100%">
            <div class="col-20 side-panel" style="height: 100%">
              <div class="block">
                <h3>Hi, Username</h3>
                <div class="list">
                  <ul>
                    <li><a href="#tab-1" class="tab-link no-ripple tab-link-active">Reports</a></li>
                    <li><a href="#tab-2" class="tab-link no-ripple">All Users</a></li>
                    <li><a href="#tab-3" class="tab-link no-ripple">Banned Users</a></li>
                    <li><a href="#tab-4" class="tab-link no-ripple">Change Password</a></li>
                    <li><a href="#tab-5" class="tab-link no-ripple">Pool Management</a></li>
                  </ul>
                </div>
                <a href="#" class="button button-fill" onclick="signOut()">Logout</a>
              </div>
            </div>
            <div class="col-80">
              <div class="tabs">
                <div id="tab-1" class="tab tab-active">
                  <div class="block">
                    <div class="list no-hairlines">
                      <ul id="reports-list">
                        <li>
                          <a href="#" class="item-link item-content">
                            <div class="item-media"><img src="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fclipart-library.com%2Fimages%2FATbrxjpyc.jpg&f=1&nofb=1" width="32px" style="border-radius: 50%" /></div>
                            <div class="item-inner">
                              <div class="item-description">Ivan Petrov reported the profile of mr_brown_pants</div>
                              <div class="item-after">8:47 PM</div>
                            </div>
                          </a>
                        </li>
                        <li>
                          <a href="#" class="item-link item-content">
                            <div class="item-media"><img src="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fclipart-library.com%2Fimages%2FATbrxjpyc.jpg&f=1&nofb=1" width="32px" style="border-radius: 50%" /></div>
                            <div class="item-inner">
                              <div class="item-description">Ivan Petrov reported the profile of mr_brown_pants</div>
                              <div class="item-after">8:47 PM</div>
                            </div>
                          </a>
                        </li>
                        <li>
                          <a href="#" class="item-link item-content">
                            <div class="item-media"><img src="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fclipart-library.com%2Fimages%2FATbrxjpyc.jpg&f=1&nofb=1" width="32px" style="border-radius: 50%" /></div>
                            <div class="item-inner">
                              <div class="item-description">Ivan Petrov reported the profile of mr_brown_pants</div>
                              <div class="item-after">8:47 PM</div>
                            </div>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div id="tab-2" class="tab">
                  <div class="block">
                    <p>Tab 2 content</p>
                  </div>
                </div>
                <div id="tab-3" class="tab">
                  <div class="block">
                    <p>Tab 3 content</p>
                  </div>
                </div>
                <div id="tab-4" class="tab">
                  <div class="block">
                    <p>Tab 4 content</p>
                  </div>
                </div>
                <div id="tab-5" class="tab">
                  <div class="block">
                    <p>Pool Management</p>
                    <div id="pool-list" class="row justify-content-space-around">
                      <div class="card pool-card col-30">
                        <div style="background-image:url(https://cdn.framework7.io/placeholder/nature-1000x600-3.jpg)" class="card-header align-items-flex-end">Pool Name</div>
                        <div class="card-content card-content-padding">
                          <p class="date">Posted on January 21, 2015</p>
                          <p>Quisque eget vestibulum nulla. Quisque quis dui quis ex ultricies efficitur vitae non felis. Phasellus quis nibh hendrerit...</p>
                        </div>
                        <div class="card-footer"><a href="#" class="link">Like</a><a href="#" class="link">Read more</a></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript" src="framework7.bundle.js"></script>
  <script type="text/javascript" src="main.js"></script>

  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-app.js"></script>
  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-analytics.js"></script>
  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-database.js"></script>


  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyDE4eEbTl4-2uRZhPotGSVMxgj6nVEhqjw",
      authDomain: "fun-sports-pools.firebaseapp.com",
      databaseURL: "https://fun-sports-pools.firebaseio.com",
      projectId: "fun-sports-pools",
      storageBucket: "fun-sports-pools.appspot.com",
      messagingSenderId: "825861071194",
      appId: "1:825861071194:web:eb3544cbf38bd07331d363",
      measurementId: "G-5LMHL36YSF"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();


    var storage = firebase.storage();

    var storageRef = storage.ref();

    //reference to the firestore database
    var db = firebase.firestore();

    var User; //An objects that contins the user data if the currently signed in user
    var uid; //This is the users id

    //Firebase authentication
    firebase.auth().onAuthStateChanged(function(user) { //This function runs every time the users authentication state changes (eg. the user signs in or out)

      //If the user is signed in
      if (user) {
        uid = user.uid;
        //direct user to main page if not already there
        db.collection("admins").doc(user.uid).get().catch(function(error) {
          console.log(error.message);
        }).then(function(userData) {
          //If the user exist then this user is an admin so load the main page
          if (userData.exists) {
            User = {
              uid: uid,
              username: userData.get("lastName"),
              firstName: userData.get("firstName"),
              lastName: userData.get("lastName"),
              fullName: function() {
                return "" + this.firstName + " " + this.lastName;
              },
              profilePic: null //profilePic,// TODO: Load that here
            };

            loadPools();
            //editPool(0, "test 2", "This is another test that has been added via the edit event function", "poolPic", "date", ['test', 'soccer']);

            console.log("Document data:", userData.data());
          } else {
            console.log("This user is not an admin!");
          }
        });
      } else { //User is signed out.
        console.log("Nobody is signed in");
        self.app.views.main.router.navigate('/login-screen/', {
          ignoreCache: true,
        });
      }
    });
  </script>
</body>

</html>